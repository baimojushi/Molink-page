<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Snaptoshine Â· è‰ºæœ¯ç©ºé—´åŒ¹é…</title>
  <style>
    /* ==========================================
       è°ƒè‰²æ¿å‡½æ•° â€”â€” ä¿®æ”¹æ­¤å¤„å³å¯å…¨å±€æ¢è‰²
       ========================================== */
    :root {
      /* ä¸»è‰²ç³»ï¼ˆæš–æ£•è°ƒï¼‰ */
      --è‰²-ä¸»è‰²: #6b4c3b;
      --è‰²-ä¸»è‰²æµ…: #8b6f5e;
      --è‰²-ä¸»è‰²ææµ…: #f5efe9;
      --è‰²-ä¸»è‰²æ·±: #4a3228;

      /* å¼ºè°ƒè‰²ï¼ˆæŠ¹èŒ¶ç»¿ï¼‰ */
      --è‰²-å¼ºè°ƒ: #7a9e7e;
      --è‰²-å¼ºè°ƒæµ…: #a8c5ab;
      --è‰²-å¼ºè°ƒæ·±: #5a7e5e;

      /* ä¸­æ€§è‰² */
      --è‰²-èƒŒæ™¯: #faf7f4;
      --è‰²-å¡ç‰‡: #ffffff;
      --è‰²-è¾¹æ¡†: #e8e0d8;
      --è‰²-æ–‡å­—ä¸»: #3a2a1a;
      --è‰²-æ–‡å­—æ¬¡: #8a7a6a;
      --è‰²-æ–‡å­—å¼±: #b8a898;
      --è‰²-ç¦ç”¨èƒŒæ™¯: #f0ebe5;
      --è‰²-ç¦ç”¨æ–‡å­—: #c8b8a8;
      --è‰²-å±é™©: #c45c4a;

      /* åœ†è§’ */
      --åœ†è§’-å°: 8px;
      --åœ†è§’-ä¸­: 12px;
      --åœ†è§’-å¤§: 16px;

      /* é˜´å½± */
      --é˜´å½±-å¡ç‰‡: 0 2px 12px rgba(106, 76, 59, 0.08);
      --é˜´å½±-æµ®èµ·: 0 8px 32px rgba(106, 76, 59, 0.15);

      /* è¿‡æ¸¡ */
      --è¿‡æ¸¡: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* ==========================================
       å…¨å±€é‡ç½®ä¸åŸºç¡€æ ·å¼
       ========================================== */
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
      background: var(--è‰²-èƒŒæ™¯);
      color: var(--è‰²-æ–‡å­—ä¸»);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
    }

    /* ==========================================
       é¡µé¢å¤´éƒ¨
       ========================================== */
    .header {
      background: var(--è‰²-ä¸»è‰²);
      color: #fff;
      padding: 16px 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .header-logo {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: 1px;
    }
    .header-sub {
      font-size: 12px;
      opacity: 0.7;
      margin-left: auto;
    }

    /* ==========================================
       ä¸»å®¹å™¨
       ========================================== */
    .container {
      max-width: 480px;
      margin: 0 auto;
      padding: 20px 16px 40px;
    }

    /* ==========================================
       åˆ†åŒºå¡ç‰‡
       ========================================== */
    .section {
      background: var(--è‰²-å¡ç‰‡);
      border-radius: var(--åœ†è§’-å¤§);
      padding: 20px;
      margin-bottom: 16px;
      box-shadow: var(--é˜´å½±-å¡ç‰‡);
      border: 1px solid var(--è‰²-è¾¹æ¡†);
    }
    .section-title {
      font-size: 14px;
      color: var(--è‰²-æ–‡å­—æ¬¡);
      margin-bottom: 14px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .section-title::before {
      content: '';
      width: 3px;
      height: 14px;
      background: var(--è‰²-ä¸»è‰²);
      border-radius: 2px;
    }

    /* ==========================================
       æœåŠ¡ç±»å‹é€‰æ‹©æŒ‰é’®ç»„
       ========================================== */
    .service-btns {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .service-btn {
      padding: 14px 16px;
      border: 2px solid var(--è‰²-è¾¹æ¡†);
      border-radius: var(--åœ†è§’-ä¸­);
      background: var(--è‰²-å¡ç‰‡);
      font-size: 15px;
      color: var(--è‰²-æ–‡å­—ä¸»);
      cursor: pointer;
      transition: var(--è¿‡æ¸¡);
      text-align: left;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .service-btn:active { transform: scale(0.98); }
    .service-btn.active {
      border-color: var(--è‰²-å¼ºè°ƒ);
      background: linear-gradient(135deg, rgba(122,158,126,0.08), rgba(122,158,126,0.03));
      color: var(--è‰²-å¼ºè°ƒæ·±);
    }
    .service-btn .icon {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      flex-shrink: 0;
    }
    .service-btn.active .icon {
      background: var(--è‰²-å¼ºè°ƒ);
      color: #fff;
    }
    .service-btn:not(.active) .icon {
      background: var(--è‰²-ç¦ç”¨èƒŒæ™¯);
      color: var(--è‰²-æ–‡å­—å¼±);
    }

    /* ==========================================
       å›¾ç‰‡ä¸Šä¼ åŒºåŸŸ
       ========================================== */
    .upload-row {
      display: flex;
      gap: 12px;
    }
    .upload-box {
      flex: 1;
      aspect-ratio: 1;
      border: 2px dashed var(--è‰²-è¾¹æ¡†);
      border-radius: var(--åœ†è§’-ä¸­);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--è¿‡æ¸¡);
      position: relative;
      overflow: hidden;
      background: var(--è‰²-ä¸»è‰²ææµ…);
    }
    .upload-box:active { transform: scale(0.97); }
    .upload-box.has-image {
      border-style: solid;
      border-color: var(--è‰²-å¼ºè°ƒ);
    }
    .upload-box.disabled {
      opacity: 0.35;
      pointer-events: none;
      background: var(--è‰²-ç¦ç”¨èƒŒæ™¯);
    }
    .upload-box .label {
      font-size: 13px;
      color: var(--è‰²-æ–‡å­—æ¬¡);
      margin-top: 8px;
    }
    .upload-box .plus {
      font-size: 32px;
      color: var(--è‰²-æ–‡å­—å¼±);
      line-height: 1;
    }
    .upload-box img.preview {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .upload-box .remove-btn {
      position: absolute;
      top: 6px;
      right: 6px;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: rgba(0,0,0,0.5);
      color: #fff;
      font-size: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 5;
      cursor: pointer;
    }
    .upload-box input[type="file"] {
      display: none;
    }

    /* ==========================================
       æ¥æ”¶æ–¹å¼
       ========================================== */
    .receive-row {
      display: flex;
      gap: 10px;
      align-items: stretch;
    }
    .receive-btn {
      padding: 12px 18px;
      border: 2px solid var(--è‰²-è¾¹æ¡†);
      border-radius: var(--åœ†è§’-ä¸­);
      background: var(--è‰²-å¡ç‰‡);
      font-size: 14px;
      color: var(--è‰²-æ–‡å­—ä¸»);
      cursor: pointer;
      transition: var(--è¿‡æ¸¡);
      white-space: nowrap;
    }
    .receive-btn.active {
      border-color: var(--è‰²-å¼ºè°ƒ);
      background: var(--è‰²-å¼ºè°ƒ);
      color: #fff;
    }
    .receive-input-wrap {
      flex: 1;
      overflow: hidden;
      max-width: 0;
      opacity: 0;
      transition: max-width 0.4s cubic-bezier(0.4,0,0.2,1), opacity 0.3s ease, margin 0.3s ease;
      margin-left: 0;
    }
    .receive-input-wrap.show {
      max-width: 300px;
      opacity: 1;
      margin-left: 10px;
    }
    .receive-input-wrap input {
      width: 100%;
      height: 100%;
      min-height: 44px;
      padding: 0 14px;
      border: 2px solid var(--è‰²-è¾¹æ¡†);
      border-radius: var(--åœ†è§’-ä¸­);
      font-size: 14px;
      color: var(--è‰²-æ–‡å­—ä¸»);
      background: var(--è‰²-å¡ç‰‡);
      outline: none;
      transition: var(--è¿‡æ¸¡);
    }
    .receive-input-wrap input:focus {
      border-color: var(--è‰²-å¼ºè°ƒ);
    }
    .receive-input-wrap input::placeholder {
      color: var(--è‰²-æ–‡å­—å¼±);
    }

    /* ==========================================
       é™„åŠ æœåŠ¡å¼€å…³
       ========================================== */
    .toggle-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 4px 0;
    }
    .toggle-label {
      font-size: 14px;
      color: var(--è‰²-æ–‡å­—ä¸»);
      flex: 1;
      line-height: 1.4;
    }
    .toggle-label small {
      display: block;
      color: var(--è‰²-æ–‡å­—æ¬¡);
      font-size: 12px;
      margin-top: 2px;
    }
    .toggle-switch {
      width: 48px;
      height: 28px;
      background: var(--è‰²-ç¦ç”¨èƒŒæ™¯);
      border-radius: 14px;
      position: relative;
      cursor: pointer;
      transition: var(--è¿‡æ¸¡);
      flex-shrink: 0;
      margin-left: 12px;
    }
    .toggle-switch.active {
      background: var(--è‰²-å¼ºè°ƒ);
    }
    .toggle-switch::after {
      content: '';
      width: 22px;
      height: 22px;
      background: #fff;
      border-radius: 50%;
      position: absolute;
      top: 3px;
      left: 3px;
      transition: var(--è¿‡æ¸¡);
      box-shadow: 0 1px 4px rgba(0,0,0,0.15);
    }
    .toggle-switch.active::after {
      left: 23px;
    }

    /* ==========================================
       æäº¤æŒ‰é’®
       ========================================== */
    .submit-btn {
      width: 100%;
      padding: 16px;
      border: none;
      border-radius: var(--åœ†è§’-ä¸­);
      background: var(--è‰²-ä¸»è‰²);
      color: #fff;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--è¿‡æ¸¡);
      letter-spacing: 2px;
    }
    .submit-btn:active:not(:disabled) {
      transform: scale(0.98);
      background: var(--è‰²-ä¸»è‰²æ·±);
    }
    .submit-btn:disabled {
      background: var(--è‰²-ç¦ç”¨èƒŒæ™¯);
      color: var(--è‰²-ç¦ç”¨æ–‡å­—);
      cursor: not-allowed;
    }

    /* ==========================================
       æˆåŠŸæç¤ºé®ç½©
       ========================================== */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }
    .overlay.show {
      opacity: 1;
      pointer-events: auto;
    }
    .success-card {
      background: var(--è‰²-å¡ç‰‡);
      border-radius: var(--åœ†è§’-å¤§);
      padding: 32px 28px;
      text-align: center;
      max-width: 320px;
      width: 90%;
      box-shadow: var(--é˜´å½±-æµ®èµ·);
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }
    .overlay.show .success-card {
      transform: scale(1);
    }
    .success-card .icon-big {
      font-size: 48px;
      margin-bottom: 16px;
    }
    .success-card h3 {
      font-size: 18px;
      margin-bottom: 8px;
      color: var(--è‰²-æ–‡å­—ä¸»);
    }
    .success-card p {
      font-size: 14px;
      color: var(--è‰²-æ–‡å­—æ¬¡);
      line-height: 1.6;
      margin-bottom: 20px;
    }
    .success-card button {
      padding: 12px 32px;
      border: none;
      border-radius: var(--åœ†è§’-ä¸­);
      background: var(--è‰²-ä¸»è‰²);
      color: #fff;
      font-size: 15px;
      cursor: pointer;
      transition: var(--è¿‡æ¸¡);
    }

    /* ==========================================
       åŠ è½½çŠ¶æ€
       ========================================== */
    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255,255,255,0.3);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin 0.6s linear infinite;
      vertical-align: middle;
      margin-right: 8px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
  </style>
</head>
<body>

  <!-- é¡µé¢å¤´éƒ¨ -->
  <div class="header">
    <div class="header-logo">Snaptoshine</div>
    <div class="header-sub">è‰ºæœ¯ç©ºé—´åŒ¹é…æœåŠ¡</div>
  </div>

  <div class="container">

    <!-- â‘  æœåŠ¡ç±»å‹é€‰æ‹© -->
    <div class="section">
      <div class="section-title">æœåŠ¡ç±»å‹é€‰æ‹©</div>
      <div class="service-btns">
        <div class="service-btn" data-type="hang_in_home" onclick="é€‰æ‹©æœåŠ¡(this)">
          <div class="icon">ğŸ–¼</div>
          <div>ä½œå“æŒ‚è¿›å®¶</div>
        </div>
        <div class="service-btn" data-type="recommend_work" onclick="é€‰æ‹©æœåŠ¡(this)">
          <div class="icon">ğŸ </div>
          <div>æ ¹æ®ç©ºé—´æ¨èä½œå“</div>
        </div>
        <div class="service-btn" data-type="recommend_space" onclick="é€‰æ‹©æœåŠ¡(this)">
          <div class="icon">ğŸ¨</div>
          <div>æ ¹æ®ä½œå“æ¨èç©ºé—´</div>
        </div>
      </div>
    </div>

    <!-- â‘¡ å›¾ç‰‡ä¸Šä¼  -->
    <div class="section">
      <div class="section-title">å›¾ç‰‡ä¸Šä¼ </div>
      <div class="upload-row">
        <!-- ä½œå“å›¾ä¸Šä¼  -->
        <div class="upload-box disabled" id="upload-artwork" onclick="è§¦å‘ä¸Šä¼ ('artwork')">
          <input type="file" id="file-artwork" accept="image/*" onchange="å¤„ç†ä¸Šä¼ (this, 'artwork')">
          <span class="plus">+</span>
          <span class="label">ä½œå“å›¾ç‰‡</span>
        </div>
        <!-- ç©ºé—´å›¾ä¸Šä¼  -->
        <div class="upload-box disabled" id="upload-space" onclick="è§¦å‘ä¸Šä¼ ('space')">
          <input type="file" id="file-space" accept="image/*" onchange="å¤„ç†ä¸Šä¼ (this, 'space')">
          <span class="plus">+</span>
          <span class="label">ç©ºé—´å›¾ç‰‡</span>
        </div>
      </div>
    </div>

    <!-- â‘¢ æ¥æ”¶æ–¹å¼ -->
    <div class="section">
      <div class="section-title">æ¥æ”¶æ–¹å¼</div>
      <div class="receive-row">
        <div class="receive-btn" data-method="email" onclick="é€‰æ‹©æ¥æ”¶æ–¹å¼(this)">ğŸ“§ é‚®ç®±</div>
        <div class="receive-btn" data-method="sms" onclick="é€‰æ‹©æ¥æ”¶æ–¹å¼(this)">ğŸ“± çŸ­ä¿¡</div>
        <div class="receive-input-wrap" id="receive-input-wrap">
          <input type="text" id="receive-target" placeholder="">
        </div>
      </div>
    </div>

    <!-- â‘£ é™„åŠ æœåŠ¡ -->
    <div class="section">
      <div class="toggle-row">
        <div class="toggle-label">
          æŒ‚ç”»åè½¯è£…é€‚é…æ€§å¾®è°ƒ
          <small>å¯é€‰é™„åŠ æœåŠ¡</small>
        </div>
        <div class="toggle-switch" id="extra-toggle" onclick="åˆ‡æ¢é™„åŠ æœåŠ¡()"></div>
      </div>
    </div>

    <!-- â‘¤ æäº¤æŒ‰é’® -->
    <button class="submit-btn" id="submit-btn" disabled onclick="æäº¤è¡¨å•()">æäº¤</button>

  </div>

  <!-- æˆåŠŸæç¤ºé®ç½© -->
  <div class="overlay" id="success-overlay">
    <div class="success-card">
      <div class="icon-big">âœ…</div>
      <h3>æäº¤æˆåŠŸ</h3>
      <p id="success-msg">å¤„ç†å®Œæˆåå°†é€šè¿‡é‚®ç®±é€šçŸ¥æ‚¨ï¼Œè¯·ç•™æ„æŸ¥æ”¶ã€‚</p>
      <button onclick="é‡ç½®è¡¨å•()">ç»§ç»­æäº¤æ–°æœåŠ¡</button>
    </div>
  </div>

  <script>
    // ==========================================
    // çŠ¶æ€ç®¡ç†
    // ==========================================
    const çŠ¶æ€ = {
      æœåŠ¡ç±»å‹: null,        // hang_in_home / recommend_work / recommend_space
      æ¥æ”¶æ–¹å¼: null,        // email / sms
      æ¥æ”¶åœ°å€: '',
      é™„åŠ æœåŠ¡: false,
      ä½œå“å›¾æ–‡ä»¶: null,
      ç©ºé—´å›¾æ–‡ä»¶: null,
      æäº¤ä¸­: false
    };

    // ==========================================
    // æœåŠ¡ç±»å‹é€‰æ‹©
    // ==========================================
    function é€‰æ‹©æœåŠ¡(btn) {
      document.querySelectorAll('.service-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      çŠ¶æ€.æœåŠ¡ç±»å‹ = btn.dataset.type;

      // æ¸…é™¤å·²æœ‰ä¸Šä¼ 
      æ¸…é™¤ä¸Šä¼ ('artwork');
      æ¸…é™¤ä¸Šä¼ ('space');

      // æ ¹æ®æœåŠ¡ç±»å‹å¯ç”¨/ç¦ç”¨ä¸Šä¼ åŒºåŸŸ
      const artworkBox = document.getElementById('upload-artwork');
      const spaceBox = document.getElementById('upload-space');

      if (çŠ¶æ€.æœåŠ¡ç±»å‹ === 'hang_in_home') {
        artworkBox.classList.remove('disabled');
        spaceBox.classList.remove('disabled');
      } else if (çŠ¶æ€.æœåŠ¡ç±»å‹ === 'recommend_work') {
        artworkBox.classList.add('disabled');
        spaceBox.classList.remove('disabled');
      } else if (çŠ¶æ€.æœåŠ¡ç±»å‹ === 'recommend_space') {
        artworkBox.classList.remove('disabled');
        spaceBox.classList.add('disabled');
      }

      æ£€æŸ¥æäº¤æ¡ä»¶();
    }

    // ==========================================
    // å›¾ç‰‡ä¸Šä¼ å¤„ç†
    // ==========================================
    function è§¦å‘ä¸Šä¼ (type) {
      const box = document.getElementById(`upload-${type}`);
      if (box.classList.contains('disabled') || box.classList.contains('has-image')) return;
      document.getElementById(`file-${type}`).click();
    }

    function å¤„ç†ä¸Šä¼ (input, type) {
      const file = input.files[0];
      if (!file) return;

      if (type === 'artwork') çŠ¶æ€.ä½œå“å›¾æ–‡ä»¶ = file;
      else çŠ¶æ€.ç©ºé—´å›¾æ–‡ä»¶ = file;

      const box = document.getElementById(`upload-${type}`);
      box.classList.add('has-image');

      // æ¸…é™¤åŸæœ‰å†…å®¹
      const oldPreview = box.querySelector('img.preview');
      const oldRemove = box.querySelector('.remove-btn');
      if (oldPreview) oldPreview.remove();
      if (oldRemove) oldRemove.remove();

      // æ˜¾ç¤ºé¢„è§ˆ
      const img = document.createElement('img');
      img.className = 'preview';
      img.src = URL.createObjectURL(file);
      box.appendChild(img);

      // åˆ é™¤æŒ‰é’®
      const removeBtn = document.createElement('div');
      removeBtn.className = 'remove-btn';
      removeBtn.textContent = 'âœ•';
      removeBtn.onclick = (e) => {
        e.stopPropagation();
        æ¸…é™¤ä¸Šä¼ (type);
      };
      box.appendChild(removeBtn);

      æ£€æŸ¥æäº¤æ¡ä»¶();
    }

    function æ¸…é™¤ä¸Šä¼ (type) {
      if (type === 'artwork') çŠ¶æ€.ä½œå“å›¾æ–‡ä»¶ = null;
      else çŠ¶æ€.ç©ºé—´å›¾æ–‡ä»¶ = null;

      const box = document.getElementById(`upload-${type}`);
      box.classList.remove('has-image');
      const preview = box.querySelector('img.preview');
      const removeBtn = box.querySelector('.remove-btn');
      if (preview) preview.remove();
      if (removeBtn) removeBtn.remove();

      document.getElementById(`file-${type}`).value = '';
      æ£€æŸ¥æäº¤æ¡ä»¶();
    }

    // ==========================================
    // æ¥æ”¶æ–¹å¼é€‰æ‹©ï¼ˆå«è¾“å…¥æ¡†æ»‘å‡ºï¼‰
    // ==========================================
    function é€‰æ‹©æ¥æ”¶æ–¹å¼(btn) {
      const method = btn.dataset.method;
      const inputWrap = document.getElementById('receive-input-wrap');
      const input = document.getElementById('receive-target');

      // åˆ‡æ¢é€‰ä¸­æ€
      document.querySelectorAll('.receive-btn').forEach(b => b.classList.remove('active'));

      if (çŠ¶æ€.æ¥æ”¶æ–¹å¼ === method) {
        // å†æ¬¡ç‚¹å‡»åŒä¸€ä¸ªï¼šå–æ¶ˆé€‰æ‹©
        çŠ¶æ€.æ¥æ”¶æ–¹å¼ = null;
        inputWrap.classList.remove('show');
        input.value = '';
        çŠ¶æ€.æ¥æ”¶åœ°å€ = '';
      } else {
        btn.classList.add('active');
        çŠ¶æ€.æ¥æ”¶æ–¹å¼ = method;
        inputWrap.classList.add('show');

        if (method === 'email') {
          input.type = 'email';
          input.placeholder = 'è¯·è¾“å…¥é‚®ç®±åœ°å€';
        } else {
          input.type = 'tel';
          input.placeholder = 'è¯·è¾“å…¥æ‰‹æœºå·';
        }

        input.value = '';
        çŠ¶æ€.æ¥æ”¶åœ°å€ = '';
        setTimeout(() => input.focus(), 400);
      }

      æ£€æŸ¥æäº¤æ¡ä»¶();
    }

    // ç›‘å¬è¾“å…¥
    document.getElementById('receive-target').addEventListener('input', (e) => {
      çŠ¶æ€.æ¥æ”¶åœ°å€ = e.target.value.trim();
      æ£€æŸ¥æäº¤æ¡ä»¶();
    });

    // ==========================================
    // é™„åŠ æœåŠ¡å¼€å…³
    // ==========================================
    function åˆ‡æ¢é™„åŠ æœåŠ¡() {
      çŠ¶æ€.é™„åŠ æœåŠ¡ = !çŠ¶æ€.é™„åŠ æœåŠ¡;
      document.getElementById('extra-toggle').classList.toggle('active', çŠ¶æ€.é™„åŠ æœåŠ¡);
    }

    // ==========================================
    // æäº¤æ¡ä»¶æ£€æŸ¥ï¼ˆæ§åˆ¶æäº¤æŒ‰é’®å¯ç”¨ï¼‰
    // ==========================================
    function æ£€æŸ¥æäº¤æ¡ä»¶() {
      let å¯æäº¤ = true;

      // å¿…é¡»é€‰æ‹©æœåŠ¡ç±»å‹
      if (!çŠ¶æ€.æœåŠ¡ç±»å‹) å¯æäº¤ = false;

      // å¿…é¡»é€‰æ‹©æ¥æ”¶æ–¹å¼å¹¶å¡«å†™åœ°å€
      if (!çŠ¶æ€.æ¥æ”¶æ–¹å¼ || !çŠ¶æ€.æ¥æ”¶åœ°å€) å¯æäº¤ = false;

      // æ ¹æ®æœåŠ¡ç±»å‹æ£€æŸ¥å›¾ç‰‡
      if (çŠ¶æ€.æœåŠ¡ç±»å‹ === 'hang_in_home') {
        if (!çŠ¶æ€.ä½œå“å›¾æ–‡ä»¶ || !çŠ¶æ€.ç©ºé—´å›¾æ–‡ä»¶) å¯æäº¤ = false;
      } else if (çŠ¶æ€.æœåŠ¡ç±»å‹ === 'recommend_work') {
        if (!çŠ¶æ€.ç©ºé—´å›¾æ–‡ä»¶) å¯æäº¤ = false;
      } else if (çŠ¶æ€.æœåŠ¡ç±»å‹ === 'recommend_space') {
        if (!çŠ¶æ€.ä½œå“å›¾æ–‡ä»¶) å¯æäº¤ = false;
      }

      document.getElementById('submit-btn').disabled = !å¯æäº¤;
    }

    // ==========================================
    // æäº¤è¡¨å•
    // ==========================================
    async function æäº¤è¡¨å•() {
      if (çŠ¶æ€.æäº¤ä¸­) return;
      çŠ¶æ€.æäº¤ä¸­ = true;

      const btn = document.getElementById('submit-btn');
      btn.innerHTML = '<span class="loading-spinner"></span>æäº¤ä¸­...';
      btn.disabled = true;

      const formData = new FormData();
      formData.append('service_type', çŠ¶æ€.æœåŠ¡ç±»å‹);
      formData.append('receive_method', çŠ¶æ€.æ¥æ”¶æ–¹å¼);
      formData.append('receive_target', çŠ¶æ€.æ¥æ”¶åœ°å€);
      formData.append('extra_service', çŠ¶æ€.é™„åŠ æœåŠ¡ ? '1' : '0');

      if (çŠ¶æ€.ä½œå“å›¾æ–‡ä»¶) formData.append('artwork', çŠ¶æ€.ä½œå“å›¾æ–‡ä»¶);
      if (çŠ¶æ€.ç©ºé—´å›¾æ–‡ä»¶) formData.append('space', çŠ¶æ€.ç©ºé—´å›¾æ–‡ä»¶);

      try {
        const resp = await fetch('/api/client/submit', {
          method: 'POST',
          body: formData
        });
        const data = await resp.json();

        if (data.success) {
          const methodText = çŠ¶æ€.æ¥æ”¶æ–¹å¼ === 'email' ? 'é‚®ç®±' : 'çŸ­ä¿¡';
          document.getElementById('success-msg').textContent =
            `å¤„ç†å®Œæˆåå°†é€šè¿‡${methodText}é€šçŸ¥æ‚¨ï¼Œè¯·ç•™æ„æŸ¥æ”¶ã€‚`;
          document.getElementById('success-overlay').classList.add('show');
        } else {
          alert(data.error || 'æäº¤å¤±è´¥ï¼Œè¯·é‡è¯•');
        }
      } catch (err) {
        alert('ç½‘ç»œå¼‚å¸¸ï¼Œè¯·æ£€æŸ¥è¿æ¥åé‡è¯•');
        console.error(err);
      } finally {
        çŠ¶æ€.æäº¤ä¸­ = false;
        btn.textContent = 'æäº¤';
        æ£€æŸ¥æäº¤æ¡ä»¶();
      }
    }

    // ==========================================
    // é‡ç½®è¡¨å•ï¼ˆæˆåŠŸåç»§ç»­æäº¤æ–°æœåŠ¡ï¼‰
    // ==========================================
    function é‡ç½®è¡¨å•() {
      document.getElementById('success-overlay').classList.remove('show');

      // é‡ç½®çŠ¶æ€
      çŠ¶æ€.æœåŠ¡ç±»å‹ = null;
      çŠ¶æ€.æ¥æ”¶æ–¹å¼ = null;
      çŠ¶æ€.æ¥æ”¶åœ°å€ = '';
      çŠ¶æ€.é™„åŠ æœåŠ¡ = false;
      çŠ¶æ€.ä½œå“å›¾æ–‡ä»¶ = null;
      çŠ¶æ€.ç©ºé—´å›¾æ–‡ä»¶ = null;

      // é‡ç½®UI
      document.querySelectorAll('.service-btn').forEach(b => b.classList.remove('active'));
      æ¸…é™¤ä¸Šä¼ ('artwork');
      æ¸…é™¤ä¸Šä¼ ('space');
      document.getElementById('upload-artwork').classList.add('disabled');
      document.getElementById('upload-space').classList.add('disabled');
      document.querySelectorAll('.receive-btn').forEach(b => b.classList.remove('active'));
      document.getElementById('receive-input-wrap').classList.remove('show');
      document.getElementById('receive-target').value = '';
      document.getElementById('extra-toggle').classList.remove('active');
      document.getElementById('submit-btn').disabled = true;
    }
  </script>
</body>
</html>
